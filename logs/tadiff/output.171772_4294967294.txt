/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/torchmetrics/utilities/imports.py:22: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import DistributionNotFound, get_distribution
wandb: Currently logged in as: allaaamr (allaaamr-mbzuai) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: setting up run 79k5oa6h
wandb: Tracking run with wandb version 0.23.1
wandb: Run data is saved locally in /home/alaa.mohamed/TaDiff/wandb/run-20251219_014723-79k5oa6h
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run run_lumiere
wandb: â­ï¸ View project at https://wandb.ai/allaaamr-mbzuai/TaDiff
wandb: ðŸš€ View run at https://wandb.ai/allaaamr-mbzuai/TaDiff/runs/79k5oa6h

Using device: cuda:0

======================================================================
TaDiff Training
======================================================================
Data directory: /l/users/alaa.mohamed/datasets/lumiere_proc
Max epochs: 30
Learning rate: 0.005
======================================================================

Loaded splits:
  Train: 37 patients
  Val: 8 patients

Valid files:
  Train: 37 patients
  Val: 8 patients


======================================================================
Sliding Window Statistics:
======================================================================
Train patients: 37 â†’ Training points: 232
Val patients: 8 â†’ Validation points: 38
Avg windows per train patient: 6.3
Avg windows per val patient: 4.8
======================================================================


Model initialized:
  Total parameters: 5,504,119
  Trainable: 5,504,119

======================================================================
Starting Training
======================================================================

Epoch 0 [Train]:   0%|          | 0/232 [00:00<?, ?it/s]Epoch 0 [Train]:   0%|          | 0/232 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/monai/transforms/transform.py", line 150, in apply_transform
    return _apply_transform(transform, data, unpack_items, lazy, overrides, log_stats)
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/monai/transforms/transform.py", line 98, in _apply_transform
    return transform(data, lazy=lazy) if isinstance(transform, LazyTrait) else transform(data)
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/monai/transforms/io/dictionary.py", line 163, in __call__
    data = self._loader(d[key], reader)
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/monai/transforms/io/array.py", line 253, in __call__
    filename = tuple(
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/monai/transforms/io/array.py", line 254, in <genexpr>
    f"{Path(s).expanduser()}" if self.expanduser else s for s in ensure_tuple(filename)  # allow Path objects
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/pathlib.py", line 960, in __new__
    self = cls._from_parts(args)
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/pathlib.py", line 594, in _from_parts
    drv, root, parts = self._parse_args(args)
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/pathlib.py", line 578, in _parse_args
    a = os.fspath(a)
TypeError: expected str, bytes or os.PathLike object, not ndarray

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/alaa.mohamed/TaDiff/scripts/train2.py", line 552, in <module>
    main()
  File "/home/alaa.mohamed/TaDiff/scripts/train2.py", line 496, in main
    train_metrics = train_epoch(model, train_loader, optimizer, device, epoch)
  File "/home/alaa.mohamed/TaDiff/scripts/train2.py", line 310, in train_epoch
    for batch_idx, batch in enumerate(pbar):
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 673, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/alaa.mohamed/TaDiff/scripts/train2.py", line 110, in __getitem__
    windowed_data = self.transform(windowed_data)
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/monai/transforms/compose.py", line 346, in __call__
    result = execute_compose(
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/monai/transforms/compose.py", line 116, in execute_compose
    data = apply_transform(
  File "/home/alaa.mohamed/.conda/envs/wm/lib/python3.10/site-packages/monai/transforms/transform.py", line 180, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x14c5b9236560>
[1;34mwandb[0m: 
[1;34mwandb[0m: ðŸš€ View run [33mrun_lumiere[0m at: [34m[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20251219_014723-79k5oa6h/logs[0m
srun: error: gpu-08: task 0: Exited with exit code 1
